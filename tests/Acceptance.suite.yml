# Codeception Test Suite Configuration
#
# Suite for acceptance tests
# Emulate web requests and make application process them
# Include one of framework modules (Symfony, Yii2, Laravel, Phalcon5) to use it
# Remove this suite if you don't use frameworks

actor: AcceptanceTester
suite_namespace: Tests\Acceptance
modules:
    # enable helpers as array
    enabled:
        - Asserts
        - \Tests\Support\Helper\Acceptance
        - WPDb
        - WPLoader
        - WPWebDriver
        - WPFilesystem
    config:
          WPDb:
              dsn: 'mysql:host=mysql;dbname=test_db'
              user: 'root'
              password: 'root'
              url: 'http://wordpress-nginx/'
              tablePrefix: 'wp_'
              populate: true
              cleanup: true
              dump: ''
              databases:
                default:
                  dsn: 'mysql:host=mysql;dbname=test_db'
                  user: 'root'
                  password: 'root'
          WPFilesystem:
              wpRootFolder: '/var/www/html/'
          WPLoader:
              wpRootFolder: '/var/www/html/'
              dbName: 'test_db'
              dbHost: 'mysql'
              dbUser: 'root'
              dbPassword: 'root'
              tablePrefix: 'wp_'
              domain: 'wordpress-nginx'
              adminEmail: 'robert2021south@gmail.com'
              title: 'Test Blog'
              loadOnly: true
          WPWebDriver:
              url: 'http://wordpress-nginx:80'
              browser: chrome
              host: selenium
              port: 4444
              restart: true
              use_w3c: true                # W3C 协议兼容
              capabilities:
                chromeOptions:
                  args:
                    - "--headless"
                    - "--disable-gpu"
                    - "--window-size=1280,1024"
                    - "--no-sandbox"
                    - "--disable-dev-shm-usage"
                    #- "--user-data-dir=/opt/selenium/tmp-profile-$$"
#                  binary: "/usr/bin/google-chrome"  # 指定完整路径
                  prefs: #首选项
                    download.default_directory: '/var/www/html/wp-content/plugins/rw-postviewstats-lite/tests/_output'  #指定自动下载文件的目录
                    download.prompt_for_download: false  #禁止弹窗“是否保存”
                    directory_upgrade: true     #如果目录不存在，自动创建；允许覆盖下载文件
                    plugins.always_open_pdf_externally: true    #PDF 不在浏览器打开，直接下载
              adminUsername: 'admin'
              adminPassword: 'pBlaWDphJvFab5Jbi3KR9q6s'
              adminPath: '/wp-login.php'
